<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cinepolis Status Dashboard</title>
<style>
  body { font-family: Arial; background: #111; color: #fff; text-align: center; }
  .status { font-size: 2em; margin: 20px; }
  .UP { color: #0f0; }
  .DOWN { color: #f00; }
  table { margin: 0 auto; border-collapse: collapse; width: 80%; }
  th, td { border: 1px solid #fff; padding: 8px; }
</style>
</head>
<body>
<h1>Cinepolis Website Status</h1>
<div id="status" class="status">Loading...</div>
<table id="logTable">
  <thead>
    <tr><th>Time</th><th>Status</th><th>Code</th></tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const maxLogs = 20;
let logs = [];

async function fetchStatus() {
  try {
    const res = await fetch('status.json?' + new Date().getTime());
    const data = await res.json();
    const statusEl = document.getElementById('status');
    statusEl.textContent = data.status;
    statusEl.className = 'status ' + data.status;

    // Update logs
    logs.unshift({time: data.checked_at, status: data.status, code: data.status_code});
    if (logs.length > maxLogs) logs.pop();

    const tbody = document.querySelector('#logTable tbody');
    tbody.innerHTML = '';
    logs.forEach(log => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${log.time}</td><td>${log.status}</td><td>${log.code}</td>`;
      tbody.appendChild(tr);
    });
  } catch(err) {
    console.error(err);
  }
}

// Auto-refresh every 5 seconds
fetchStatus();
setInterval(fetchStatus, 5000);
</script>
</body>
</html>
